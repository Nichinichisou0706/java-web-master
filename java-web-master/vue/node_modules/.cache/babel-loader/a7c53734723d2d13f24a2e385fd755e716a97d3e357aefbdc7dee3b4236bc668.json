{"ast":null,"code":"import request from \"../../utils/request\";\nimport Cookies from 'js-cookie';\nimport * as echarts from 'echarts';\nexport default {\n  name: \"manageScore\",\n  data() {\n    // 验证是否是[0-100]的整数\n    const checkScore = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('输入不可以为空'));\n      }\n      setTimeout(() => {\n        if (!Number(value) && value !== 0) {\n          callback(new Error('请输入[0,100]之间的整数'));\n        } else {\n          const re = /^[0-9]*[1-9][0-9]*$/;\n          const rsCheck = re.test(value);\n          if (!rsCheck) {\n            callback(new Error('请输入[0,100]之间的整数'));\n          }\n          if (value < 0 || value > 100) {\n            callback(new Error('请输入[0,100]之间的整数'));\n          } else {\n            callback();\n          }\n        }\n      }, 100);\n    };\n    return {\n      user: Cookies.get('user') ? JSON.parse(Cookies.get('user')) : {},\n      teachId: '',\n      tableData: [],\n      form: {},\n      dialogVisible: false,\n      params: {\n        id: '',\n        studentId: '',\n        level: ''\n      },\n      rules: {\n        score: [{\n          validator: checkScore,\n          trigger: 'blur'\n        }]\n      },\n      length1: '',\n      length3: '',\n      length4: '',\n      length5: ''\n    };\n  },\n  mounted: async function () {\n    await this.Init();\n    this.$nextTick(function () {\n      let data = [{\n        name: '不及格',\n        value: this.length1\n      }, {\n        name: '良',\n        value: this.length3\n      }, {\n        name: '好',\n        value: this.length4\n      }, {\n        name: '优',\n        value: this.length5\n      }];\n      this.getPie(data);\n    });\n  },\n  created() {\n    const id = this.$route.query.id;\n    this.params.id = id;\n    if (id === '' || id == null) {\n      this.$notify.warning(\"请从任课信息进入该页面哦~\");\n    } else {\n      this.load();\n    }\n  },\n  methods: {\n    load() {\n      request.get(\"/tea/manageScore\", {\n        params: this.params\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data;\n        } else {\n          alert(res.msg);\n        }\n      });\n    },\n    async Init() {\n      await this.init1();\n      await this.init3();\n      await this.init4();\n      await this.init5();\n    },\n    async init1() {\n      this.params.level = 1;\n      await request.get(\"/tea/manageScore\", {\n        params: this.params\n      }).then(res => {\n        this.length1 = res.data.length;\n      });\n      this.params.level = '';\n    },\n    async init3() {\n      this.params.level = 3;\n      await request.get(\"/tea/manageScore\", {\n        params: this.params\n      }).then(res => {\n        this.length3 = res.data.length;\n      });\n      this.params.level = '';\n    },\n    async init4() {\n      this.params.level = 4;\n      await request.get(\"/tea/manageScore\", {\n        params: this.params\n      }).then(res => {\n        this.length4 = res.data.length;\n      });\n      this.params.level = '';\n    },\n    async init5() {\n      this.params.level = 5;\n      await request.get(\"/tea/manageScore\", {\n        params: this.params\n      }).then(res => {\n        this.length5 = res.data.length;\n      });\n      this.params.level = '';\n    },\n    handleEdit(row) {\n      if (row.score === -1) {\n        row.score = '';\n      }\n      this.form = JSON.parse(JSON.stringify(row));\n      this.dialogVisible = true;\n    },\n    closeDialog() {\n      this.dialogVisible = false;\n      this.load();\n    },\n    scoreFormat(row) {\n      return row.score === -1 ? '成绩未录入' : row.score;\n    },\n    update() {\n      this.$refs['ruleForm'].validate(valid => {\n        if (valid) {\n          request.post(\"/tea/update\", this.form).then(res => {\n            if (res.code === '200') {\n              this.$notify.success(\"编辑成功\");\n              this.$refs['ruleForm'].resetFields();\n              this.dialogVisible = false;\n              this.load();\n            } else {\n              this.$notify.error(res.msg);\n            }\n          });\n        }\n      });\n    },\n    getPie(data) {\n      // 绘制图表\n      let myChart = echarts.init(document.getElementById('main'));\n      // 指定图表的配置项和数据\n      let option = {\n        //标题\n        title: {\n          text: '成绩扇形图',\n          x: 'left',\n          //标题位置\n          textStyle: {\n            //标题内容的样式\n            color: '#000',\n            fontStyle: 'normal',\n            fontWeight: 100,\n            fontSize: 16 //主题文字字体大小，默认为18px\n          }\n        },\n\n        // stillShowZeroSum: true,\n        //鼠标划过时饼状图上显示的数据\n        tooltip: {\n          trigger: 'item',\n          formatter: '{a}<br/>{b}:{c} ({d}%)'\n        },\n        //图例\n        legend: {\n          //图例  标注各种颜色代表的模块\n          // orient: 'vertical',//图例的显示方式  默认横向显示\n          bottom: 10,\n          //控制图例出现的距离  默认左上角\n          left: 'center',\n          //控制图例的位置\n          textStyle: {\n            //图例中文字的样式\n            color: '#000',\n            fontSize: 16\n          },\n          data: ['不及格', '良', '好', '优'] //图例上显示的饼图各模块上的名字\n        },\n\n        //饼图中各模块的颜色\n        color: ['#32dadd', '#b6a2de', '#5ab1ef', '#faaaef'],\n        // 饼图数据\n        series: {\n          type: 'pie',\n          //echarts图的类型   pie代表饼图\n          radius: '70%',\n          //饼图中饼状部分的大小所占整个父元素的百分比\n          center: ['50%', '50%'],\n          //整个饼图在整个父元素中的位置\n          data: data,\n          itemStyle: {\n            label: {\n              show: true //饼图上是否出现标注文字 标注各模块代表什么  默认是true\n              // position: 'inner',//控制饼图上标注文字相对于饼图的位置  默认位置在饼图外\n            },\n\n            labelLine: {\n              show: true //官网demo里外部标注上的小细线的显示隐藏    默认显示\n            }\n          }\n        }\n      };\n      // 使用刚指定的配置项和数据显示图表。\n      myChart.setOption(option);\n    }\n  }\n};","map":{"version":3,"names":["request","Cookies","echarts","name","data","checkScore","rule","value","callback","Error","setTimeout","Number","re","rsCheck","test","user","get","JSON","parse","teachId","tableData","form","dialogVisible","params","id","studentId","level","rules","score","validator","trigger","length1","length3","length4","length5","mounted","Init","$nextTick","getPie","created","$route","query","$notify","warning","load","methods","then","res","code","alert","msg","init1","init3","init4","init5","length","handleEdit","row","stringify","closeDialog","scoreFormat","update","$refs","validate","valid","post","success","resetFields","error","myChart","init","document","getElementById","option","title","text","x","textStyle","color","fontStyle","fontWeight","fontSize","tooltip","formatter","legend","bottom","left","series","type","radius","center","itemStyle","label","show","labelLine","setOption"],"sources":["src/views/tea/manageScore.vue"],"sourcesContent":["<template>\n  <div>\n    <!--搜索框-->\n    <div style=\"margin-bottom: 15px\">\n      <el-input style=\"width: 180px; margin-left: 5px\" placeholder=\"请输入学号\" v-model=\"params.studentId\"></el-input>\n      <el-select v-model=\"params.level\" style=\"margin-left: 5px; width: 100px\" placeholder=\"请选择身份\">\n        <el-option label=\"成绩等级\" value=\"\"></el-option>\n        <el-option label=\"不及格\" value=\"1\"></el-option>\n        <el-option label=\"及格\" value=\"2\"></el-option>\n        <el-option label=\"良\" value=\"3\"></el-option>\n        <el-option label=\"好\" value=\"4\"></el-option>\n        <el-option label=\"优\" value=\"5\"></el-option>\n      </el-select>\n      <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"load\"><i class=\"el-icon-search\"></i>&ensp;搜索</el-button>\n    </div>\n\n    <el-table :data=\"tableData\" border stripe style=\"width: 450px\">\n      <el-table-column sortable prop=\"studentId\" label=\"学号\" ></el-table-column>\n      <el-table-column prop=\"studentName\" label=\"姓名\"></el-table-column>\n      <el-table-column sortable prop=\"score\" :formatter=\"scoreFormat\" label=\"成绩\" ></el-table-column>\n      <el-table-column fixed=\"right\" label=\"操作\" width=\"75px\">\n        <template #default=\"scope\">\n          <el-button size=\"mini\" type=\"primary\" @click=\"handleEdit(scope.row)\">编辑</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <div style=\"margin-top: 50px\">\n      <div id=\"main\" style=\"width:900px ;height:300px;\"></div>\n    </div>\n\n\n\n    <!--编辑时的弹窗-->\n    <el-dialog title=\"编辑成绩\" :visible.sync=\"dialogVisible\" width=\"30%\" >\n      <el-form :inline=\"true\" :model=\"form\" label-width=\"120px\" :rules=\"rules\" ref=\"ruleForm\">\n        <el-form-item label=\"学号\">\n          <el-input v-model=\"form.studentId\" readonly style=\"width: 75%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"姓名\">\n          <el-input v-model=\"form.studentName\" readonly  style=\"width: 75%\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"成绩\" prop=\"score\">\n          <el-input v-model=\"form.score\" style=\"width: 75%\"></el-input>\n        </el-form-item>\n      </el-form>\n      <template #footer>\n              <span class=\"dialog-footer\">\n                <el-button @click=\"closeDialog\">取消</el-button>\n                <el-button type=\"primary\" @click=\"update\">确认</el-button>\n              </span>\n      </template>\n    </el-dialog>\n\n  </div>\n\n</template>\n\n<script>\n\nimport request from \"../../utils/request\";\nimport Cookies from 'js-cookie';\nimport * as echarts from 'echarts';\n\n\nexport default {\n  name: \"manageScore\",\n  data() {\n\n    // 验证是否是[0-100]的整数\n    const checkScore = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('输入不可以为空'))\n      }\n      setTimeout(() => {\n        if (!Number(value) && value !== 0) {\n          callback(new Error('请输入[0,100]之间的整数'))\n        } else {\n          const re = /^[0-9]*[1-9][0-9]*$/;\n          const rsCheck = re.test(value);\n          if (!rsCheck) {\n            callback(new Error('请输入[0,100]之间的整数'));\n          }\n          if (value < 0 || value > 100) {\n            callback(new Error('请输入[0,100]之间的整数'));\n          } else {\n            callback();\n          }\n        }\n      }, 100)\n    };\n\n\n    return {\n      user: Cookies.get('user') ? JSON.parse(Cookies.get('user')) : {},\n      teachId: '',\n      tableData: [],\n      form: {},\n      dialogVisible: false,\n      params: {\n        id: '',\n        studentId: '',\n        level: '',\n      },\n      rules: {\n        score: [\n          { validator: checkScore, trigger: 'blur' }\n        ],\n      },\n      length1: '',\n      length3: '',\n      length4: '',\n      length5: '',\n\n    }\n\n\n  },\n\n  mounted: async function() {\n    await this.Init();\n    this.$nextTick(function() {\n      let data = [\n        {name: '不及格', value: this.length1},\n        {name: '良', value: this.length3},\n        {name: '好', value: this.length4},\n        {name: '优', value: this.length5},\n      ]\n      this.getPie(data);\n    })\n  },\n\n  created() {\n    const id = this.$route.query.id;\n    this.params.id = id;\n    if (id === '' || id == null){\n      this.$notify.warning(\"请从任课信息进入该页面哦~\")\n    } else {\n      this.load();\n    }\n  },\n\n  methods: {\n\n    load() {\n      request.get(\"/tea/manageScore\", {params: this.params}).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data;\n        } else {\n          alert(res.msg);\n        }\n      })\n    },\n\n    async Init() {\n      await this.init1();\n      await this.init3();\n      await this.init4();\n      await this.init5();\n    },\n\n    async init1() {\n      this.params.level = 1;\n      await request.get(\"/tea/manageScore\", {params: this.params}).then(res => {\n        this.length1 = res.data.length;\n      });\n      this.params.level = '';\n    },\n\n    async init3() {\n      this.params.level = 3;\n      await request.get(\"/tea/manageScore\", {params: this.params}).then(res => {\n        this.length3 = res.data.length;\n      });\n      this.params.level = '';\n    },\n\n    async init4() {\n      this.params.level = 4;\n      await request.get(\"/tea/manageScore\", {params: this.params}).then(res => {\n        this.length4 = res.data.length;\n      });\n      this.params.level = '';\n    },\n\n    async init5() {\n        this.params.level = 5;\n        await request.get(\"/tea/manageScore\", {params: this.params}).then(res => {\n          this.length5 = res.data.length;\n        });\n        this.params.level = '';\n    },\n\n    handleEdit(row) {\n      if (row.score === -1) {\n        row.score = '';\n      }\n      this.form = JSON.parse(JSON.stringify(row));\n      this.dialogVisible = true;\n    },\n\n    closeDialog() {\n      this.dialogVisible = false;\n      this.load();\n    },\n\n    scoreFormat(row) {\n      return row.score === -1 ? '成绩未录入' : row.score;\n    },\n\n    update() {\n      this.$refs['ruleForm'].validate((valid) => {\n        if (valid) {\n          request.post(\"/tea/update\", this.form).then(res => {\n            if (res.code === '200') {\n              this.$notify.success(\"编辑成功\");\n              this.$refs['ruleForm'].resetFields();\n              this.dialogVisible = false;\n              this.load();\n            } else {\n              this.$notify.error(res.msg);\n            }\n          })\n        }\n      })\n    },\n\n    getPie(data) {\n      // 绘制图表\n      let myChart = echarts.init(document.getElementById('main'));\n      // 指定图表的配置项和数据\n       let option = {\n          //标题\n          title: {\n            text: '成绩扇形图',\n            x: 'left',              //标题位置\n            textStyle: { //标题内容的样式\n              color: '#000',\n              fontStyle: 'normal',\n              fontWeight: 100,\n              fontSize: 16 //主题文字字体大小，默认为18px\n            },\n          },\n          // stillShowZeroSum: true,\n          //鼠标划过时饼状图上显示的数据\n          tooltip: {\n            trigger: 'item',\n            formatter: '{a}<br/>{b}:{c} ({d}%)'\n          },\n          //图例\n          legend: {//图例  标注各种颜色代表的模块\n            // orient: 'vertical',//图例的显示方式  默认横向显示\n            bottom: 10,//控制图例出现的距离  默认左上角\n            left: 'center',//控制图例的位置\n            textStyle: {//图例中文字的样式\n              color: '#000',\n              fontSize: 16\n            },\n            data: ['不及格', '良', '好', '优']  //图例上显示的饼图各模块上的名字\n          },\n          //饼图中各模块的颜色\n          color: ['#32dadd', '#b6a2de', '#5ab1ef', '#faaaef'],\n          // 饼图数据\n          series: {\n            type: 'pie',             //echarts图的类型   pie代表饼图\n            radius: '70%',           //饼图中饼状部分的大小所占整个父元素的百分比\n            center: ['50%', '50%'],  //整个饼图在整个父元素中的位置\n            data: data,\n            itemStyle: {\n              label: {\n                show: true,//饼图上是否出现标注文字 标注各模块代表什么  默认是true\n                // position: 'inner',//控制饼图上标注文字相对于饼图的位置  默认位置在饼图外\n              },\n              labelLine: {\n                show: true  //官网demo里外部标注上的小细线的显示隐藏    默认显示\n              }\n            }\n          },\n      }\n      // 使用刚指定的配置项和数据显示图表。\n      myChart.setOption(option);\n    },\n\n  }\n}\n</script>\n\n<style scoped>\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}