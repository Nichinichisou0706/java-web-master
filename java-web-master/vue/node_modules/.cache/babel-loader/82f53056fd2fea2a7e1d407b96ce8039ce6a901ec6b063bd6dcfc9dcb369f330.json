{"ast":null,"code":"import request from \"../../utils/request\";\nexport default {\n  name: \"list\",\n  data() {\n    const checkNumber = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('输入不可以为空'));\n      }\n      setTimeout(() => {\n        if (!Number(value)) {\n          callback(new Error('请输入正整数'));\n        } else {\n          const re = /^[1-9][0-9]{0,1}$/;\n          const rsCheck = re.test(value);\n          if (!rsCheck) {\n            callback(new Error('请输入正整数，值为【1,99】'));\n          } else {\n            callback();\n          }\n        }\n      }, 0);\n    };\n    return {\n      total: '',\n      dialogVisible: false,\n      tableData: [],\n      rooms: [],\n      courses: [],\n      teachers: [],\n      form: {},\n      params: {\n        teacherId: '',\n        courseCode: '',\n        pageNum: 1,\n        pageSize: 10\n      },\n      rules: {\n        day: [{\n          required: true,\n          message: '请选择周几上课',\n          trigger: 'blur'\n        }],\n        time: [{\n          required: true,\n          message: '请选择上课时间',\n          trigger: 'blur'\n        }],\n        teacherId: [{\n          required: true,\n          message: '请选择教师职工号',\n          trigger: 'blur'\n        }],\n        courseCode: [{\n          required: true,\n          message: '请选择课程代码',\n          trigger: 'blur'\n        }],\n        roomId: [{\n          required: true,\n          message: '请选择上课教室',\n          trigger: 'blur'\n        }],\n        max: [{\n          validator: checkNumber,\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  //页面加载之后会调用\n  created() {\n    this.init();\n    this.load();\n  },\n  methods: {\n    init() {\n      request.get('/teach/room/list').then(res => {\n        this.rooms = res.data;\n      });\n      request.get('/user/teacher/list').then(res => {\n        this.teachers = res.data;\n      });\n      request.get('/course/list').then(res => {\n        this.courses = res.data;\n      });\n    },\n    setTeacher() {\n      let teacher = this.teachers.find(item => item.username === this.form.teacherId);\n      request.get('/user/' + teacher.id).then(res => {\n        this.$set(this.form, 'teacherName', res.data.name);\n      });\n    },\n    setCourse() {\n      let course = this.courses.find(item => item.courseCode === this.form.courseCode);\n      request.get('/course/' + course.id).then(res => {\n        this.$set(this.form, 'courseName', res.data.courseName);\n        this.$set(this.form, 'begin', res.data.begin);\n        this.$set(this.form, 'end', res.data.end);\n      });\n    },\n    load() {\n      request.get(\"/teach/page\", {\n        params: this.params\n      }).then(res => {\n        if (res.code === '200') {\n          this.tableData = res.data.list;\n          this.total = res.data.total;\n        } else {\n          alert(res.msg);\n        }\n      });\n    },\n    reset() {\n      this.params = {\n        teacherId: '',\n        courseCode: '',\n        pageNum: 1,\n        pageSize: 10\n      };\n      this.load();\n    },\n    handleCurrentChange(pageNum) {\n      this.params.pageNum = pageNum;\n      this.load();\n    },\n    handleSizeChange(pageSize) {\n      this.params.pageSize = pageSize;\n      this.load();\n    },\n    handleDelete(id) {\n      request.delete('/teach/delete/' + id).then(res => {\n        if (res.code === '200') {\n          alert(\"删除成功\");\n          this.load();\n        } else {\n          alert(res.msg);\n        }\n      });\n    },\n    add() {\n      this.form = {};\n      this.dialogVisible = true;\n    },\n    save() {\n      this.$refs['ruleForm'].validate(valid => {\n        if (valid) {\n          request.post(\"/teach/add\", this.form).then(res => {\n            if (res.code === '200') {\n              this.$notify.success(\"排课成功\");\n              this.form = {};\n              this.dialogVisible = false;\n              this.load();\n            } else {\n              this.$notify.error(res.msg);\n            }\n          });\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["request","name","data","checkNumber","rule","value","callback","Error","setTimeout","Number","re","rsCheck","test","total","dialogVisible","tableData","rooms","courses","teachers","form","params","teacherId","courseCode","pageNum","pageSize","rules","day","required","message","trigger","time","roomId","max","validator","created","init","load","methods","get","then","res","setTeacher","teacher","find","item","username","id","$set","setCourse","course","courseName","begin","end","code","list","alert","msg","reset","handleCurrentChange","handleSizeChange","handleDelete","delete","add","save","$refs","validate","valid","post","$notify","success","error"],"sources":["src/views/teach/list.vue"],"sourcesContent":["<template>\n    <div>\n\n        <!--搜索框-->\n        <div style=\"margin-bottom: 15px\">\n            <el-input style=\"width: 240px\" placeholder=\"请输入商家号\" v-model=\"params.teacherId\"></el-input>\n            <el-input style=\"width: 240px; margin-left: 5px\" placeholder=\"请输入景点代码\" v-model=\"params.courseCode\"></el-input>\n            <el-button style=\"margin-left: 5px\" type=\"primary\" @click=\"load\"><i class=\"el-icon-search\"></i>&ensp;搜索</el-button>\n            <el-button style=\"margin-left: 5px\" type=\"warning\" @click=\"reset\"><i class=\"el-icon-refresh\"></i>&ensp;重置</el-button>\n            <el-button style=\"margin-left: 5px\" type=\"success\" @click=\"add\"><i class=\"el-icon-add-location\"></i>&ensp;新增景点</el-button>\n        </div>\n\n        <el-table :data=\"tableData\" border stripe>\n            <el-table-column prop=\"teacherId\" label=\"商家号\"></el-table-column>\n            <el-table-column prop=\"teacherName\" label=\"商家姓名\" ></el-table-column>\n            <el-table-column prop=\"courseName\" label=\"景点名\"></el-table-column>\n            <el-table-column prop=\"courseCode\" label=\"景点代码\" ></el-table-column>\n            <el-table-column prop=\"day\" label=\"时间\" ></el-table-column>\n            <el-table-column prop=\"time\" label=\"时间\" ></el-table-column>\n            <el-table-column prop=\"begin\" label=\"起始\" ></el-table-column>\n            <el-table-column prop=\"end\" label=\"结束\" ></el-table-column>\n            <el-table-column prop=\"roomName\" label=\"地点\"></el-table-column>\n            <el-table-column prop=\"now\" label=\"已购人数\"></el-table-column>\n            <el-table-column prop=\"max\" label=\"限购人数\"></el-table-column>\n            <el-table-column fixed=\"right\" label=\"操作\">\n                <template #default=\"scope\">\n                    <el-popconfirm title=\"您确定要删除吗?\" @confirm=\"handleDelete(scope.row.id)\">\n                        <template #reference>\n                            <el-button size=\"mini\" type=\"danger\">删除</el-button>\n                        </template>\n                    </el-popconfirm>\n                </template>\n            </el-table-column>\n        </el-table>\n\n        <!--分页-->\n        <div style=\"margin-top: 20px\">\n            <el-pagination\n                    background\n                    @size-change=\"handleSizeChange\"\n                    @current-change=\"handleCurrentChange\"\n                    layout=\"total, sizes, prev, pager, next, jumper\"\n                    :current-page=\"params.pageNum\"\n                    :page-sizes=\"[5, 10, 20]\"\n                    :page-size=\"params.pageSize\"\n                    :total=\"total\">\n            </el-pagination>\n        </div>\n\n        <el-dialog title=\"新增景点\" :visible.sync=\"dialogVisible\" width=\"30%\">\n            <el-form :model=\"form\" label-width=\"120px\" :rules=\"rules\" ref=\"ruleForm\">\n                <el-form-item label=\"商家名字\" prop=\"teacherName\">\n                    <el-input v-model=\"form.teacherName\" readonly style=\"width: 75%;\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"商家号\" prop=\"teacherId\">\n                    <el-select v-model=\"form.teacherId\" clearable filterable placeholder=\"请选择\" @change=\"setTeacher\">\n                        <el-option\n                                v-for=\"item in teachers\"\n                                :key=\"item.id\"\n                                :label=\"item.username\"\n                                :value=\"item.username\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"景点名\" prop=\"courseName\">\n                    <el-input v-model=\"form.courseName\" readonly style=\"width: 75%;\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"景点代码\" prop=\"courseCode\">\n                    <el-select v-model=\"form.courseCode\" clearable filterable placeholder=\"请选择\" @change=\"setCourse\">\n                        <el-option\n                                v-for=\"item in courses\"\n                                :key=\"item.id\"\n                                :label=\"item.courseCode\"\n                                :value=\"item.courseCode\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"起始\">\n                    <el-input v-model=\"form.begin\" readonly style=\"width: 30%;\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"结束\">\n                    <el-input v-model=\"form.end\" readonly style=\"width: 30%;\"></el-input>\n                </el-form-item>\n                <el-form-item label=\"星期几\" prop=\"day\">\n                    <el-select v-model=\"form.day\" placeholder=\"请选择周几\">\n                        <el-option label=\"周一\" value=\"周一\"></el-option>\n                        <el-option label=\"周二\" value=\"周二\"></el-option>\n                        <el-option label=\"周三\" value=\"周三\"></el-option>\n                        <el-option label=\"周四\" value=\"周四\"></el-option>\n                        <el-option label=\"周五\" value=\"周五\"></el-option>\n                        <el-option label=\"周六\" value=\"周六\"></el-option>\n                        <el-option label=\"周七\" value=\"周七\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"开放时间\" prop=\"time\">\n                    <el-select v-model=\"form.time\" placeholder=\"请选择开放时间\">\n                        <el-option label=\"8:00-10:00\" value=\"8:00-10:00\"></el-option>\n                        <el-option label=\"10:00-12:00\" value=\"10:00-12:00\"></el-option>\n                        <el-option label=\"12:00-14:00\" value=\"12:00-14:00\"></el-option>\n                        <el-option label=\"14:00-16:00\" value=\"14:00-16:00\"></el-option>\n                        <el-option label=\"16:00-18:00\" value=\"16:00-18:00\"></el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"上课教室\" prop=\"roomId\">\n                    <el-select v-model=\"form.roomId\" clearable filterable placeholder=\"请选择\">\n                        <el-option\n                                v-for=\"item in rooms\"\n                                :key=\"item.id\"\n                                :label=\"item.name\"\n                                :value=\"item.id\">\n                        </el-option>\n                    </el-select>\n                </el-form-item>\n                <el-form-item label=\"限选人数\" prop=\"max\">\n                    <el-input v-model=\"form.max\" style=\"width: 30%;\"></el-input>\n                </el-form-item>\n            </el-form>\n            <template #footer>\n          <span class=\"dialog-footer\">\n            <el-button @click=\"dialogVisible = false\">取消</el-button>\n            <el-button type=\"primary\" @click=\"save\">确认</el-button>\n          </span>\n            </template>\n        </el-dialog>\n\n    </div>\n\n</template>\n\n<script>\n\n    import request from \"../../utils/request\";\n\n    export default {\n        name: \"list\",\n        data() {\n\n            const checkNumber = (rule, value, callback) => {\n                if (!value) {\n                    return callback(new Error('输入不可以为空'));\n                }\n                setTimeout(() => {\n                    if (!Number(value)) {\n                        callback(new Error('请输入正整数'));\n                    } else {\n                        const re = /^[1-9][0-9]{0,1}$/;\n                        const rsCheck = re.test(value);\n                        if (!rsCheck) {\n                            callback(new Error('请输入正整数，值为【1,99】'));\n                        } else {\n                            callback();\n                        }\n                    }\n                }, 0);\n            };\n\n\n            return {\n                total: '',\n                dialogVisible: false,\n                tableData: [],\n                rooms: [],\n                courses: [],\n                teachers: [],\n                form: {},\n                params: {\n                    teacherId: '',\n                    courseCode:'',\n                    pageNum: 1,\n                    pageSize: 10,\n                },\n                rules: {\n                    day: [\n                        { required: true, message: '请选择周几上课', trigger: 'blur'}\n                    ],\n                    time: [\n                        { required: true, message: '请选择上课时间', trigger: 'blur'}\n                    ],\n                    teacherId: [\n                        { required: true, message: '请选择教师职工号', trigger: 'blur'}\n                    ],\n                    courseCode: [\n                        { required: true, message: '请选择课程代码', trigger: 'blur'}\n                    ],\n                    roomId: [\n                        { required: true, message: '请选择上课教室', trigger: 'blur'}\n                    ],\n                    max: [\n                        { validator: checkNumber, trigger: 'blur' }\n                    ],\n                }\n            }\n        },\n        //页面加载之后会调用\n        created() {\n            this.init();\n            this.load();\n        },\n        methods: {\n\n            init() {\n                request.get('/teach/room/list').then(res => {\n                    this.rooms = res.data;\n                });\n                request.get('/user/teacher/list').then(res => {\n                    this.teachers = res.data;\n                });\n                request.get('/course/list').then(res => {\n                    this.courses = res.data;\n                });\n            },\n\n            setTeacher(){\n                let teacher = this.teachers.find(item => item.username === this.form.teacherId);\n                request.get('/user/' + teacher.id).then(res => {\n                    this.$set(this.form, 'teacherName', res.data.name);\n                })\n            },\n\n            setCourse(){\n                let course = this.courses.find(item => item.courseCode === this.form.courseCode);\n                request.get('/course/' + course.id).then(res => {\n                    this.$set(this.form, 'courseName', res.data.courseName);\n                    this.$set(this.form, 'begin', res.data.begin);\n                    this.$set(this.form, 'end', res.data.end);\n                })\n            },\n\n            load() {\n                request.get(\"/teach/page\", { params: this.params }).then(res => {\n                    if (res.code === '200'){\n                        this.tableData = res.data.list;\n                        this.total = res.data.total;\n                    } else {\n                        alert(res.msg);\n                    }\n                })\n            },\n\n            reset() {\n                this.params = {\n                    teacherId: '',\n                    courseCode:'',\n                    pageNum: 1,\n                    pageSize: 10,\n                };\n                this.load();\n            },\n\n            handleCurrentChange(pageNum){\n                this.params.pageNum = pageNum;\n                this.load();\n            },\n\n            handleSizeChange(pageSize){\n                this.params.pageSize = pageSize;\n                this.load();\n            },\n\n            handleDelete(id){\n                request.delete('/teach/delete/' + id).then(res => {\n                    if (res.code === '200'){\n                        alert(\"删除成功\");\n                        this.load();\n                    } else {\n                        alert(res.msg);\n                    }\n                })\n            },\n\n            add(){\n                this.form = {};\n                this.dialogVisible = true;\n            },\n\n            save() {\n                this.$refs['ruleForm'].validate((valid) => {\n                    if (valid) {\n                        request.post(\"/teach/add\",this.form).then(res => {\n                            if (res.code === '200'){\n                                this.$notify.success(\"排课成功\");\n                                this.form = {};\n                                this.dialogVisible = false;\n                                this.load();\n                            } else {\n                                this.$notify.error(res.msg);\n                            }\n                        })\n                    }\n                })\n            }\n\n        }\n    }\n</script>\n\n<style scoped>\n\n</style>"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}